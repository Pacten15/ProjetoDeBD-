CREATE VIEW vendas(ean, cat, ano, trimestre, mes, dia_semana, distrito, concelho, unidades)
AS 
SELECT ean, cat, EXTRACT(YEAR FROM instante), EXTRACT(QUARTER FROM instante), EXTRACT(MONTH FROM instante), DAYOFWEEK(instante), distrito, concelho, unidades
FROM evento_reposicao a, produto b, instalada_em c, ponto_de_retalho d
WHERE a.ean=b.ean
AND b.num_serie=c.num_serie
AND b.fabricante=c.fabricante
AND c.local = d.nome;